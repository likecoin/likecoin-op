-- Create "accounts" table
CREATE TABLE "accounts" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "evm_address" character varying NOT NULL,
  "staked_amount" numeric NOT NULL,
  "pending_reward_amount" numeric NOT NULL,
  "claimed_reward_amount" numeric NOT NULL,
  PRIMARY KEY ("id")
);
-- Create index "account_evm_address" to table: "accounts"
CREATE UNIQUE INDEX "account_evm_address" ON "accounts" ("evm_address");
-- Create "evm_events" table
CREATE TABLE "evm_events" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "transaction_hash" character varying NOT NULL,
  "transaction_index" bigint NOT NULL,
  "chain_id" numeric NOT NULL,
  "block_hash" character varying NOT NULL,
  "block_number" numeric NOT NULL,
  "log_index" bigint NOT NULL,
  "address" character varying NOT NULL,
  "topic0" character varying NOT NULL,
  "topic0_hex" character varying NOT NULL,
  "topic1" character varying NULL,
  "topic1_hex" character varying NULL,
  "topic2" character varying NULL,
  "topic2_hex" character varying NULL,
  "topic3" character varying NULL,
  "topic3_hex" character varying NULL,
  "data" character varying NULL,
  "data_hex" character varying NULL,
  "removed" boolean NOT NULL,
  "status" character varying NOT NULL,
  "name" character varying NOT NULL,
  "signature" character varying NOT NULL,
  "indexed_params" jsonb NOT NULL,
  "non_indexed_params" jsonb NOT NULL,
  "failed_reason" character varying NULL,
  "timestamp" timestamptz NOT NULL,
  PRIMARY KEY ("id")
);
-- Create index "evmevent_address" to table: "evm_events"
CREATE INDEX "evmevent_address" ON "evm_events" ("address");
-- Create index "evmevent_block_number" to table: "evm_events"
CREATE INDEX "evmevent_block_number" ON "evm_events" ("block_number");
-- Create index "evmevent_log_index" to table: "evm_events"
CREATE INDEX "evmevent_log_index" ON "evm_events" ("log_index");
-- Create index "evmevent_signature" to table: "evm_events"
CREATE INDEX "evmevent_signature" ON "evm_events" ("signature");
-- Create index "evmevent_transaction_hash_transaction_index_block_number_log_in" to table: "evm_events"
CREATE UNIQUE INDEX "evmevent_transaction_hash_transaction_index_block_number_log_in" ON "evm_events" ("transaction_hash", "transaction_index", "block_number", "log_index");
-- Create "nft_classes" table
CREATE TABLE "nft_classes" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "address" character varying NOT NULL,
  "staked_amount" numeric NOT NULL,
  "last_staked_at" timestamptz NOT NULL,
  "number_of_stakers" bigint NOT NULL DEFAULT 0,
  PRIMARY KEY ("id")
);
-- Create index "nftclass_address" to table: "nft_classes"
CREATE UNIQUE INDEX "nftclass_address" ON "nft_classes" ("address");
-- Create "staking_events" table
CREATE TABLE "staking_events" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "event_type" character varying NOT NULL DEFAULT 'staked',
  "staked_amount_added" numeric NOT NULL,
  "staked_amount_removed" numeric NOT NULL,
  "reward_amount_added" numeric NOT NULL,
  "reward_amount_removed" numeric NOT NULL,
  "datetime" timestamptz NOT NULL,
  "account_id" bigint NOT NULL,
  "nft_class_id" bigint NOT NULL,
  PRIMARY KEY ("id"),
  CONSTRAINT "staking_events_accounts_account" FOREIGN KEY ("account_id") REFERENCES "accounts" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT "staking_events_nft_classes_nft_class" FOREIGN KEY ("nft_class_id") REFERENCES "nft_classes" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION
);
-- Create index "stakingevent_event_type" to table: "staking_events"
CREATE INDEX "stakingevent_event_type" ON "staking_events" ("event_type");
-- Create "stakings" table
CREATE TABLE "stakings" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "pool_share" character varying NOT NULL,
  "staked_amount" numeric NOT NULL,
  "pending_reward_amount" numeric NOT NULL,
  "claimed_reward_amount" numeric NOT NULL,
  "account_id" bigint NOT NULL,
  "nft_class_id" bigint NOT NULL,
  PRIMARY KEY ("id"),
  CONSTRAINT "stakings_accounts_account" FOREIGN KEY ("account_id") REFERENCES "accounts" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT "stakings_nft_classes_nft_class" FOREIGN KEY ("nft_class_id") REFERENCES "nft_classes" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION
);
-- Create index "staking_nft_class_id_account_id" to table: "stakings"
CREATE UNIQUE INDEX "staking_nft_class_id_account_id" ON "stakings" ("nft_class_id", "account_id");
